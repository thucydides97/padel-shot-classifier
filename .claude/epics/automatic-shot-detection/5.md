---
name: Implement confidence scoring and type prediction
status: closed
created: 2025-11-22T21:39:47Z
updated: 2025-11-23T10:49:22Z
github: [Will be updated when synced to GitHub]
depends_on: []
parallel: false
conflicts_with: []
---

# Task: Implement confidence scoring and type prediction

## Description
Add confidence scoring for detected shots based on signal clarity, and implement preliminary shot type prediction (bandeja/vibora/smash) using feature ranges from the existing classifier knowledge.

## Acceptance Criteria
- [ ] Detection confidence score (0-1) based on signal quality
- [ ] Type confidence score (0-1) for shot classification
- [ ] Preliminary type prediction using feature thresholds
- [ ] Mark type as "unknown" when confidence < threshold
- [ ] Flag low-confidence detections (< 0.7) with warning

## Technical Details
**Detection confidence factors:**
- Peak velocity prominence (clear peak = high confidence)
- Signal-to-noise ratio in velocity
- Window duration reasonableness
- Pose quality during shot (% valid landmarks)

**Type prediction (simple heuristic):**
- Smash: highest contact point, fastest velocity
- Vibora: medium contact, side spin indicators
- Bandeja: controlled velocity, lower contact point

```python
def calculate_confidence(shot, signals):
    scores = [
        peak_prominence_score(shot, signals.velocity),
        signal_clarity_score(shot, signals),
        duration_score(shot),
        pose_quality_score(shot, signals.pose_quality)
    ]
    return np.mean(scores)
```

**Files affected:**
- src/padel_shot_classifier/shot_detector.py

## Dependencies
- [ ] Task 003 - Boundary refinement

## Effort Estimate
- Size: M
- Hours: 4-5
- Parallel: false

## Definition of Done
- [ ] Confidence scoring implemented
- [ ] Type prediction heuristics implemented
- [ ] Low-confidence flagging works
- [ ] Unit tests for scoring functions
